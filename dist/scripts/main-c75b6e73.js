angular.module("gtrApp.config",[]).constant("config",{refreshInterval:90,teams:{myTeam:{members:["f-dubost","a-samson","m-brunot"],orgs:["m6web","Replay"],apiUrl:"https://github.m6web.fr/api/v3"}}}),angular.module("gtrApp",["ngRoute","gtrApp.config"]).config(["$routeProvider","config",function(e,t){e.when("/:team",{templateUrl:"views/main.html",controller:"MainCtrl",resolve:{team:["$q","$route","config",function(e,t,r){var a=e.defer();return r.teams[t.current.params.team]?a.resolve(t.current.params.team):a.reject("Team does not exist"),a.promise}]}}).otherwise({redirectTo:"/"+Object.keys(t.teams)[0]})}]),angular.module("gtrApp").provider("PullFetcher",function(){var e="https://api.github.com";this.$get=["$http",function(t){var r,a,n,l={pulls:{},setTeam:function(t){r=t,a=t.apiUrl||e,n={},t.token&&(n={Authorization:"token "+t.token});for(var l in this.pulls)delete this.pulls[l]},refreshPulls:function(){var e=this;angular.forEach(e.pulls,function(t,r){s(t.url).then(function(t){"closed"===t.data.state&&delete e.pulls[r]})}),r.orgs.forEach(function(e){c(a+"/orgs/"+e)}),r.members.forEach(function(e){c(a+"/users/"+e)})}},s=function(e){return t({url:e,headers:n})},u=function(e){return-1!==r.members.indexOf(e.user.login)},o=function(e){s(e.statuses_url).then(function(t){e.statuses=t.data})},i=function(e){return s(e.pulls_url.replace("{/number}","")).then(function(e){var t=e.data.filter(u);return t.forEach(o),t})},c=function(e,t){void 0===t&&(t=1),s(e+"/repos?per_page=100&page="+t).then(function(r){r.data.forEach(function(e){i(e).then(function(e){e.forEach(function(e){l.pulls[e.id]=e})})}),r.data.length&&c(e,t+1)})};return l}]}),angular.module("gtrApp").controller("MainCtrl",["$scope","$location","$interval","PullFetcher","config","team",function(e,t,r,a,n,l){e.pulls=a.pulls,e.teams=n.teams,e.team=l,e.toArray=function(e){var t=[];return angular.forEach(e,function(e){t.push(e)}),t},e.$watch("team",function(e){t.path(e)}),e.$on("$destroy",function(){r.cancel(s)});var s=r(function(){a.refreshPulls()},1e3*n.refreshInterval);a.setTeam(e.teams[l]),a.refreshPulls()}]),function(e){try{e=angular.module("gtrApp")}catch(t){e=angular.module("gtrApp",[])}e.run(["$templateCache",function(e){e.put("views/main.html",'<header class="header-top"><a href="http://github.com/m6web/GithubTeamReviewer">Github Team Reviewer</a> by <a href="http://tech.m6web.fr">M6Web</a><select ng-model="team" ng-options="teamName as teamName for (teamName, team) in teams"></select></header><div class="container"><ul class="pulls"><li ng-repeat="pr in toArray(pulls) | orderBy:\'updated_at\':true" ng-class="pr.statuses[0].state" class="status"><img class="avatar" ng-src="{{ pr.user.avatar_url}}"> <span class="link"><a ng-href="{{pr.html_url}}">#{{ pr.number }} {{ pr.title }}</a></span> <span class="date pull-right">{{pr.updated_at | date:"dd/MM/yyyy"}}</span> <span class="repo pull-right"><a ng-href="{{pr.head.repo.html_url}}">{{ pr.head.repo.full_name }}</a></span></li></ul></div>')}])}();